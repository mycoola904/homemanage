{% extends "base.html" %}

{% block title %}{{ page_title }}{% endblock title %}

{% block content %}
<div class="p-6 space-y-6">
    <a href="{% url 'financial:accounts-index' %}" class="link link-hover text-sm">&larr; Back to Accounts</a>

    <div class="grid gap-6 lg:grid-cols-3">
        <div class="lg:col-span-2 space-y-4">
            <c-ui.card>
                <div class="space-y-3">
                    <h1 class="text-3xl font-bold">{{ account.name }}</h1>
                    {% if account.institution %}
                        <p class="text-base-content/70">{{ account.institution }}</p>
                    {% endif %}
                    <div class="badge badge-outline">{{ account.get_account_type_display }}</div>
                </div>
            </c-ui.card>

            <c-ui.card>
                {% include "financial/accounts/_preview.html" with preview=preview %}
            </c-ui.card>
        </div>

        <div>
            <c-ui.card>
                <h2 class="text-xl font-semibold mb-2">Status</h2>
                <span class="{{ preview.status_badge_class }}">{{ preview.status_label }}</span>
            </c-ui.card>
        </div>
    </div>

    <section id="account-transactions">
        <c-ui.card>
            <div class="flex flex-wrap items-center justify-between gap-3">
                <div>
                    <h2 class="text-xl font-semibold">Transactions</h2>
                    <p class="text-base-content/70">Review recent activity for this account.</p>
                </div>
                <button type="button"
                        class="btn btn-sm btn-primary"
                        hx-get="{{ transactions_new_url }}"
                        hx-target="#account-transactions-body"
                        hx-swap="innerHTML"
                        hx-request="queue:last"
                        hx-disabled-elt="this">
                    Add Transaction
                </button>
            </div>

            <div id="account-transactions-body" class="mt-4">
                {% include "financial/accounts/transactions/_body.html" with transaction_rows=transaction_rows has_transactions=has_transactions %}
            </div>
        </c-ui.card>
    </section>
</div>
{% endblock content %}
